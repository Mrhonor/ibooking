{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { login } from '@/api/request.js';\nexport default {\n  name: \"MyLogin\",\n\n  data() {\n    // 用户名的校验方法\n    // let validateName = (rule, value, callback) => {\n    //   if (!value) {\n    //     return callback(new Error(\"请输入用户名\"));\n    //   }\n    //   // 用户名以字母开头,长度在5-16之间,允许字母数字下划线\n    //   const userNameRule = /^[a-zA-Z][a-zA-Z0-9_]{4,15}$/;\n    //   if (userNameRule.test(value)) {\n    //     this.$refs.ruleForm.validateField(\"checkPass\");\n    //     return callback();\n    //   } else {\n    //     return callback(new Error(\"字母开头,长度5-16之间,允许字母数字下划线\"));\n    //   }\n    // };\n    // 密码的校验方法\n    // let validatePass = (rule, value, callback) => {\n    //   if (value === \"\") {\n    //     return callback(new Error(\"请输入密码\"));\n    //   }\n    //   // 密码以字母开头,长度在6-18之间,允许字母数字和下划线\n    //   const passwordRule = /^[a-zA-Z]\\w{5,17}$/;\n    //   if (passwordRule.test(value)) {\n    //     this.$refs.ruleForm.validateField(\"checkPass\");\n    //     return callback();\n    //   } else {\n    //     return callback(\n    //       new Error(\"字母开头,长度6-18之间,允许字母数字和下划线\")\n    //     );\n    //   }\n    // };\n    return {\n      isLogin: true,\n      LoginUser: {\n        name: \"\",\n        pass: \"\"\n      } // 用户信息校验规则,validator(校验方法),trigger(触发方式),blur为在组件 Input 失去焦点时触发\n      // rules: {\n      //   name: [{ validator: validateName, trigger: \"blur\" }],\n      //   pass: [{ validator: validatePass, trigger: \"blur\" }]\n      // }\n\n    };\n  },\n\n  computed: {},\n  methods: {\n    beforeClose() {\n      return false;\n    },\n\n    Login() {\n      // const form = new FormData()\n      // form.append('username_login', this.LoginUser.name)\n      // form.append('password_login', this.LoginUser.pass)\n      const params = {\n        username: this.LoginUser.name,\n        password: this.LoginUser.pass\n      };\n      login(params).then(res => {\n        if (res && res.success === true) {\n          localStorage.setItem(\"username\", this.LoginUser.name);\n          localStorage.setItem(\"password\", this.LoginUser.pass); // localStorage.setItem(\"role\", res.data[2]);\n\n          this.$router.push('/task');\n          this.$message.success('登录成功');\n        } else {\n          this.$message.error('用户名或密码错误');\n        }\n      });\n    }\n\n  }\n};","map":null,"metadata":{},"sourceType":"module"}