{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Seat from \"@/components/Seat\";\nexport default {\n  name: \"Area\",\n  components: {\n    Seat\n  },\n\n  data() {\n    return {\n      blankRows: [],\n      lastBlankIndex: -1\n    };\n  },\n\n  props: {\n    manageMode: {\n      type: Boolean,\n      default: false\n    },\n    seatRows: {\n      type: Array\n    }\n  },\n  methods: {\n    closeLastPop() {\n      for (let i = 0; i < this.blankRows.length; i++) {\n        this.blankRows[i].show = false;\n      }\n\n      for (let i = 0; i < this.seatRows.length; i++) {\n        this.seatRows[i].show = false;\n      }\n    },\n\n    seatClick(index) {\n      this.closeLastPop();\n      this.seatRows[index].show = true;\n      this.$emit('seatClick', index);\n    },\n\n    closeOnOutside(ev) {\n      if (ev.target.getAttribute('class') === null || ev.target.getAttribute('class').indexOf('seat') === -1) {\n        this.closeLastPop();\n      }\n    },\n\n    blankClick(index) {\n      if (!this.manageMode) {\n        return;\n      }\n\n      this.lastBlankIndex = index;\n      this.closeLastPop();\n      this.blankRows[index].show = true;\n      index += 1;\n      let row, column;\n\n      if (index % 25 === 0) {\n        row = Math.trunc(index / 25);\n        column = 25;\n      } else {\n        row = Math.trunc(index / 25) + 1;\n        column = index % 25;\n      } // console.log(row+'-'+column)\n\n\n      this.$emit('blankClick', index, row, column);\n    }\n\n  },\n\n  created() {\n    //定义空白方块数组\n    for (let i = 0; i < 225; i++) {\n      this.blankRows.push({\n        show: false\n      });\n    }\n\n    window.addEventListener('click', this.closeOnOutside);\n  },\n\n  destroyed() {\n    window.removeEventListener('click', this.closeOnOutside);\n  },\n\n  watch: {\n    seatRows(n, o) {\n      this.lastBlankIndex = -1;\n    }\n\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCA;AAEA;EACAA,YADA;EAEAC;IAAAC;EAAA,CAFA;;EAGAC;IACA;MACAC,aADA;MAEAC;IAFA;EAIA,CARA;;EASAC;IACAC;MACAC,aADA;MAEAC;IAFA,CADA;IAKAC;MACAF;IADA;EALA,CATA;EAkBAG;IACAC;MACA;QACA;MACA;;MACA;QACA;MACA;IACA,CARA;;IASAC;MACA;MACA;MACA;IACA,CAbA;;IAcAC;MACA,gDACAC,sDADA,EACA;QACA;MACA;IACA,CAnBA;;IAoBAC;MACA;QACA;MACA;;MACA;MACA;MACA;MAEAC;MACA;;MACA;QACAC;QACAC;MACA,CAHA,MAGA;QACAD;QACAC;MACA,CAhBA,CAiBA;;;MACA;IACA;;EAvCA,CAlBA;;EA2DAC;IACA;IACA;MACA;QACAC;MADA;IAGA;;IAEAC;EACA,CApEA;;EAqEAC;IACAD;EACA,CAvEA;;EAwEAE;IACAd;MACA;IACA;;EAHA;AAxEA","names":["name","components","Seat","data","blankRows","lastBlankIndex","props","manageMode","type","default","seatRows","methods","closeLastPop","seatClick","closeOnOutside","ev","blankClick","index","row","column","created","show","window","destroyed","watch"],"sourceRoot":"src/components","sources":["Area.vue"],"sourcesContent":["<template>\r\n    <div>\r\n      <div class=\"room\">\r\n        <!--      显示底部网格-->\r\n        <div v-for=\"(item,index) in blankRows\" class=\"item\" @click=\"blankClick(index)\">\r\n          <div v-if=\"!item.show\" class=\"seat\"></div>\r\n          <van-popover v-else v-model=\"item.show\" :offset=\"[0,0]\"\r\n                       placement=\"top\" theme=\"dark\">\r\n            <slot name=\"blankMenu\"></slot>\r\n            <template #reference>\r\n              <div class=\"seat\" :class=\"index===lastBlankIndex?'seatSelect':''\"></div>\r\n            </template>\r\n          </van-popover>\r\n        </div>\r\n      </div>\r\n      <div class=\"room\" style=\"margin-top: -288px\">\r\n        <!--      显示座位-->\r\n        <div v-for=\"(item,index) in seatRows\" @click=\"seatClick(index)\"\r\n             class=\"item\" :style=\"'grid-row:'+item.row+';grid-column:'+ item.column\">\r\n          <seat v-if=\"!item.show\" :item=\"item\"></seat>\r\n          <van-popover v-else v-model=\"item.show\" :offset=\"[0,0]\"\r\n                       placement=\"top\" theme=\"dark\">\r\n            <slot name=\"seatMenu\"></slot>\r\n            <template #reference>\r\n              <seat :item=\"item\"></seat>\r\n            </template>\r\n          </van-popover>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  \r\n  </template>\r\n  \r\n  <script>\r\n  import Seat from \"@/components/Seat\";\r\n  \r\n  export default {\r\n    name: \"Area\",\r\n    components: {Seat},\r\n    data() {\r\n      return {\r\n        blankRows: [],\r\n        lastBlankIndex: -1,\r\n      }\r\n    },\r\n    props: {\r\n      manageMode: {\r\n        type: Boolean,\r\n        default: false\r\n      },\r\n      seatRows: {\r\n        type: Array\r\n      }\r\n    },\r\n    methods: {\r\n      closeLastPop() {\r\n        for (let i = 0; i < this.blankRows.length; i++) {\r\n          this.blankRows[i].show = false\r\n        }\r\n        for (let i = 0; i < this.seatRows.length; i++) {\r\n          this.seatRows[i].show = false\r\n        }\r\n      },\r\n      seatClick(index) {\r\n        this.closeLastPop()\r\n        this.seatRows[index].show = true\r\n        this.$emit('seatClick', index)\r\n      },\r\n      closeOnOutside(ev) {\r\n        if (ev.target.getAttribute('class') === null ||\r\n            ev.target.getAttribute('class').indexOf('seat') === -1) {\r\n          this.closeLastPop()\r\n        }\r\n      },\r\n      blankClick(index) {\r\n        if (!this.manageMode) {\r\n          return\r\n        }\r\n        this.lastBlankIndex = index\r\n        this.closeLastPop()\r\n        this.blankRows[index].show = true\r\n  \r\n        index += 1;\r\n        let row, column\r\n        if (index % 25 === 0) {\r\n          row = Math.trunc(index / 25)\r\n          column = 25\r\n        } else {\r\n          row = Math.trunc(index / 25) + 1\r\n          column = index % 25\r\n        }\r\n        // console.log(row+'-'+column)\r\n        this.$emit('blankClick', index, row, column)\r\n      }\r\n    },\r\n    created() {\r\n      //定义空白方块数组\r\n      for (let i = 0; i < 225; i++) {\r\n        this.blankRows.push({\r\n          show: false\r\n        })\r\n      }\r\n  \r\n      window.addEventListener('click', this.closeOnOutside)\r\n    },\r\n    destroyed() {\r\n      window.removeEventListener('click', this.closeOnOutside)\r\n    },\r\n    watch: {\r\n      seatRows(n, o) {\r\n        this.lastBlankIndex = -1\r\n      }\r\n    }\r\n  }\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .room {\r\n    display: grid;\r\n    /*background: #e4e4e4;*/\r\n    grid-template-rows: repeat(9, 32px);\r\n    grid-template-columns: repeat(25, 32px);\r\n  }\r\n  \r\n  .item {\r\n    width: 32px;\r\n    height: 32px;\r\n  }\r\n  \r\n  \r\n  </style>\r\n  "]},"metadata":{},"sourceType":"module"}