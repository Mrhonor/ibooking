{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport layout from '@/components/layout-page.vue';\nimport { accountDownload, accountUpload, accountQuery, accountRemoveall } from '@/api/request';\nimport { saveAs } from 'file-saver';\nexport default {\n  components: {\n    layout\n  },\n\n  data() {\n    return {\n      accountVal: 'ALL',\n      options: [{\n        label: '全部',\n        value: 'ALL'\n      }, {\n        label: '正常',\n        value: 'NORMAL'\n      }, {\n        label: '异常',\n        value: 'ERROR'\n      }, {\n        label: '频繁',\n        value: 'PINGFAN'\n      }],\n      currentPage: 1,\n      pagesize: 10,\n      total: 10,\n      tableData: []\n    };\n  },\n\n  methods: {\n    handleSizeChange() {},\n\n    handleCurrentChange() {},\n\n    upload(file) {\n      console.log(file);\n      const form = new FormData();\n      form.append('username_login', localStorage.getItem('username'));\n      form.append('password_login', localStorage.getItem('password'));\n      form.append('file', file.raw);\n      accountUpload(form).then(res => {\n        if (res && res.ok === 1) {\n          this.query();\n          this.$message.success('上传成功');\n        } else {\n          this.$message.error('上传失败');\n        }\n      });\n    },\n\n    download(val) {\n      const form = new FormData();\n      form.append('username_login', localStorage.getItem('username'));\n      form.append('password_login', localStorage.getItem('password'));\n      form.append('seltype', val);\n      accountDownload(form).then(res => {\n        if (res) {\n          let str = new Blob([res], {\n            type: 'text/plain;charset=utf-8'\n          });\n          saveAs(str, 'download.txt');\n          this.$message.success('导出成功');\n        }\n      });\n    },\n\n    query() {\n      const form = new FormData();\n      form.append('username_login', localStorage.getItem('username'));\n      form.append('password_login', localStorage.getItem('password'));\n      form.append('seltype', this.accountVal);\n      form.append('pagenum', this.currentPage);\n      form.append('pagesize', this.pagesize);\n      accountQuery(form).then(res => {\n        if (res && res.data) {\n          this.tableData = res.data.data;\n          this.total = res.data.total;\n        }\n      });\n    },\n\n    clear() {\n      const form = new FormData();\n      form.append('username_login', localStorage.getItem('username'));\n      form.append('password_login', localStorage.getItem('password'));\n      this.$confirm('此操作将清空所有数据, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        accountRemoveall(form).then(res => {\n          if (res && res.ok) {\n            this.query();\n            this.$message.success('清空成功');\n          }\n        });\n      }).catch(() => {\n        this.$message.info('已取消');\n      });\n    }\n\n  },\n\n  mounted() {\n    this.query();\n  }\n\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CA;AACA;AACA;AAEA;EACAA;IACAC;EADA,CADA;;EAIAC;IACA;MACAC,iBADA;MAEAC,UACA;QAAAC;QAAAC;MAAA,CADA,EAEA;QAAAD;QAAAC;MAAA,CAFA,EAGA;QAAAD;QAAAC;MAAA,CAHA,EAIA;QAAAD;QAAAC;MAAA,CAJA,CAFA;MAQAC,cARA;MASAC,YATA;MAUAC,SAVA;MAWAC;IAXA;EAaA,CAlBA;;EAmBAC;IACAC,qBADA;;IAEAC,wBAFA;;IAGAC;MACAC;MACA;MACAC;MACAA;MACAA;MAEAC;QACA;UACA;UACA;QACA,CAHA,MAGA;UACA;QACA;MACA,CAPA;IAQA,CAlBA;;IAmBAC;MACA;MACAF;MACAA;MACAA;MAEAG;QACA;UACA;YAAAC;UAAA;UACAC;UACA;QACA;MACA,CANA;IAOA,CAhCA;;IAiCAC;MACA;MACAN;MACAA;MACAA;MACAA;MACAA;MAEAO;QACA;UACA;UACA;QACA;MACA,CALA;IAMA,CA/CA;;IAgDAC;MACA;MACAR;MACAA;MACA;QACAS,uBADA;QAEAC,sBAFA;QAGAN;MAHA,GAIAO,IAJA,CAIA;QACAC;UACA;YACA;YACA;UACA;QACA,CALA;MAMA,CAXA,EAWAC,KAXA,CAWA;QACA;MACA,CAbA;IAgBA;;EApEA,CAnBA;;EAyFAC;IACA;EACA;;AA3FA","names":["components","layout","data","accountVal","options","label","value","currentPage","pagesize","total","tableData","methods","handleSizeChange","handleCurrentChange","upload","console","form","accountUpload","download","accountDownload","type","saveAs","query","accountQuery","clear","confirmButtonText","cancelButtonText","then","accountRemoveall","catch","mounted"],"sourceRoot":"src/views","sources":["account-management.vue"],"sourcesContent":["<template>\r\n    <layout>\r\n        <div>\r\n            <el-button type=\"primary\" @click=\"download('ALL')\">导出全部账号</el-button>\r\n            <el-button type=\"primary\" @click=\"download('NORMAL')\">导出正常账号</el-button>\r\n            <el-button type=\"primary\" @click=\"download('ERROR')\">导出异常账号</el-button>\r\n            <el-button type=\"primary\" @click=\"download('PINGFAN')\">导出频繁账号</el-button>\r\n            <el-button type=\"primary\" @click=\"clear\">清空</el-button>\r\n            <el-select v-model=\"accountVal\" clearable placeholder=\"请选择\">\r\n                <el-option\r\n                v-for=\"item in options\"\r\n                :key=\"item.value\"\r\n                :label=\"item.label\"\r\n                :value=\"item.value\">\r\n                </el-option>\r\n            </el-select>\r\n            <el-button type=\"primary\" @click=\"query\">查询</el-button>\r\n            <el-table :data=\"tableData\" border style=\"width: 100%\">\r\n                <el-table-column type=\"index\" label=\"序号\" align=\"center\" width=\"55px\"/>\r\n                <el-table-column prop=\"sub\" label=\"Sub\"  align=\"center\"/>\r\n                <el-table-column prop=\"uname\" label=\"账号名\"  align=\"center\"/>\r\n                <el-table-column prop=\"state\" label=\"账号状态\" align=\"center\" width=\"200px\"/>\r\n                <el-table-column prop=\"counter_dianzan\" label=\"点赞次数\"  align=\"center\" width=\"100px\"/>\r\n                <el-table-column prop=\"counter_zhuanfa\" label=\"转发次数\"  align=\"center\" width=\"100px\"/>\r\n                <el-table-column prop=\"counter_pinglun\" label=\"评论次数\"  align=\"center\" width=\"100px\"/>\r\n            </el-table>\r\n            <el-pagination\r\n                @size-change=\"handleSizeChange\"\r\n                @current-change=\"handleCurrentChange\"\r\n                :current-page=\"currentPage\"\r\n                :page-sizes=\"[10, 20, 30, 50]\"\r\n                :page-size=\"10\"\r\n                layout=\"total, sizes, prev, pager, next, jumper\"\r\n                :total=\"total\">\r\n            </el-pagination>\r\n            <el-upload\r\n                class=\"upload-demo\"\r\n                action=\"https://jsonplaceholder.typicode.com/posts/\"\r\n                :on-change=\"upload\"\r\n                multiple>\r\n                <el-button type=\"primary\">导入账号</el-button>\r\n            </el-upload>\r\n        </div>\r\n    </layout>\r\n</template>\r\n<script>\r\nimport layout from '@/components/layout-page.vue'\r\nimport { accountDownload, accountUpload, accountQuery, accountRemoveall } from '@/api/request'\r\nimport { saveAs } from 'file-saver'\r\n\r\nexport default ({\r\n    components: {\r\n        layout\r\n    },\r\n    data() {\r\n      return {\r\n        accountVal: 'ALL',\r\n        options: [\r\n            {label: '全部', value: 'ALL'},\r\n            {label: '正常', value: 'NORMAL'},\r\n            {label: '异常', value: 'ERROR'},\r\n            {label: '频繁', value: 'PINGFAN'},\r\n        ],\r\n        currentPage: 1,\r\n        pagesize: 10,\r\n        total: 10,\r\n        tableData: []\r\n      }\r\n    },\r\n    methods: {\r\n        handleSizeChange() {},\r\n        handleCurrentChange() {},\r\n        upload(file) {\r\n            console.log(file);\r\n            const form = new FormData()\r\n            form.append('username_login', localStorage.getItem('username'))\r\n            form.append('password_login', localStorage.getItem('password'))\r\n            form.append('file', file.raw)\r\n\r\n            accountUpload(form).then((res) => {\r\n                if(res && res.ok === 1) {\r\n                    this.query()\r\n                    this.$message.success('上传成功');\r\n                } else {\r\n                    this.$message.error('上传失败');\r\n                }\r\n            })\r\n        },\r\n        download(val) {\r\n            const form = new FormData()\r\n            form.append('username_login', localStorage.getItem('username'))\r\n            form.append('password_login', localStorage.getItem('password'))\r\n            form.append('seltype', val)\r\n\r\n            accountDownload(form).then((res) => {\r\n                if(res) {\r\n                    let str = new Blob([res], { type: 'text/plain;charset=utf-8'})\r\n                    saveAs(str, 'download.txt')\r\n                    this.$message.success('导出成功');\r\n                } \r\n            })\r\n        },\r\n        query() {\r\n            const form = new FormData()\r\n            form.append('username_login', localStorage.getItem('username'))\r\n            form.append('password_login', localStorage.getItem('password'))\r\n            form.append('seltype', this.accountVal)\r\n            form.append('pagenum', this.currentPage)\r\n            form.append('pagesize', this.pagesize)\r\n\r\n            accountQuery(form).then((res) => {\r\n                if(res && res.data) {\r\n                    this.tableData = res.data.data\r\n                    this.total = res.data.total\r\n                } \r\n            })\r\n        },\r\n        clear() {\r\n            const form = new FormData()\r\n            form.append('username_login', localStorage.getItem('username'))\r\n            form.append('password_login', localStorage.getItem('password'))\r\n            this.$confirm('此操作将清空所有数据, 是否继续?', '提示', {\r\n                confirmButtonText: '确定',\r\n                cancelButtonText: '取消',\r\n                type: 'warning'\r\n                }).then(() => {\r\n                    accountRemoveall(form).then((res) => {\r\n                        if(res && res.ok) {\r\n                            this.query()\r\n                            this.$message.success('清空成功')\r\n                        } \r\n                    })\r\n                }).catch(() => {\r\n                    this.$message.info('已取消')       \r\n                });\r\n\r\n            \r\n        }\r\n    },\r\n    mounted() {\r\n        this.query()\r\n    },\r\n})\r\n</script>\r\n<style scoped>\r\n.el-table {\r\n    margin-top: 15px;\r\n}\r\n.upload-demo {\r\n    display: inline-block;\r\n    margin-top: 15px;\r\n}\r\n.el-pagination {\r\n    margin-top: 15px;\r\n    float: right;\r\n}\r\n.el-select {\r\n    margin-left: 15px;\r\n    margin-right: 15px;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}