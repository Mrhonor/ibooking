"use strict";(self["webpackChunkvue_project"]=self["webpackChunkvue_project"]||[]).push([[246,222],{7253:function(t,e,i){i.r(e),i.d(e,{default:function(){return m}});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("layout",[i("div",[i("el-steps",{attrs:{active:t.active,"finish-status":"success"}},[i("el-step",{attrs:{title:"选择自习室"}}),i("el-step",{attrs:{title:"选择座位"}}),i("el-step",{attrs:{title:"选择时间"}}),i("el-step",{attrs:{title:"预约"}})],1),i("div",{staticClass:"block",staticStyle:{margin:"20px auto"}},[i("span",{staticClass:"demonstration"},[t._v("选择日期： ")]),i("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"选择日期","picker-options":t.pickerOptions1},on:{change:t.query},model:{value:t.value2,callback:function(e){t.value2=e},expression:"value2"}})],1),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[i("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"55px"}}),i("el-table-column",{attrs:{prop:"startTime",type:"datatime",label:"预约时间",align:"center"}}),i("el-table-column",{attrs:{prop:"endTime",type:"datatime",label:"结束时间",align:"center"}})],1),i("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":10,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange}}),i("div",{staticClass:"block",staticStyle:{"margin-top":"60px","margin-bottom":"20px"}},[i("span",{staticClass:"demonstration"},[t._v("选择时间： ")]),i("el-time-select",{attrs:{placeholder:"起始时间","picker-options":{start:this.start,step:"00:15",end:this.end}},on:{change:function(e){return t.Limite(t.startTime)}},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}}),i("span",{staticClass:"demonstration",staticStyle:{"margin-right":"5px","margin-left":"5px"}},[t._v("至")]),i("el-time-select",{attrs:{placeholder:"结束时间","picker-options":{start:this.start,step:"00:15",end:this.end,minTime:this.startTime,maxTime:this.timeLimite}},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:"endTime"}})],1),i("el-button",{attrs:{type:"primary"},on:{click:t.sure}},[t._v("确 定")]),i("el-button",{on:{click:t.renew}},[t._v("重 置")])],1)])},a=[],n=i(9907),r=i(6446),l=(i(185),{components:{layout:n["default"]},data(){return{currentPage:1,pagesize:10,total:10,tableData:[],active:2,pickerOptions1:{shortcuts:[{text:"今天",onClick(t){t.$emit("pick",new Date)}},{text:"明天",onClick(t){const e=new Date;e.setTime(e.getTime()+864e5),t.$emit("pick",e)}},{text:"后天",onClick(t){const e=new Date;e.setTime(e.getTime()+1728e5),t.$emit("pick",e)}}]},value2:"",chooseDd:"",seatNum:this.$route.query.seatnum,roomNum:this.$route.query.roomnum,start:this.$route.query.st,end:this.$route.query.et,startTime:"",endTime:"",timeLimite:"",form:{index:"",stuRoomNumber:"",buildingNumber:"",classRoomNumber:"",openStatus:"",time:"",returnTime:[]},open:!0}},methods:{handleCurrentChange(t){this.currentPage=t,this.query()},Limite(t){let e=parseInt(t.split(":")[1])+1;this.timeLimite=(parseInt(t)+4).toString().padStart(2,"0")+":"+e.toString().padStart(2,"0")},next(){this.active++>3&&(this.active=0)},query(){(0,r.Rk)(this.seatNum).then((t=>{if(t){this.tableData=[];for(let e in t){let i=new Date(t[e].startTime),s=i.getDate(),a=i.getFullYear(),n=i.getMonth()+1,r=a+"-"+n+"-"+s;i=new Date(this.value2),s=i.getDate(),a=this.value2.getFullYear(),n=this.value2.getMonth()+1,this.chooseDd=a+"-"+n+"-"+s,r==this.chooseDd&&this.tableData.push(t[e])}this.total=this.tableData.length}}))},sure(){if(!this.startTime||!this.endTime)return void this.$message.info("请选择预约开始时间和结束时间！");let t=this.chooseDd+" "+this.startTime+":00",e=this.chooseDd+" "+this.endTime+":00",i={seatId:this.seatNum,startTime:t,endTime:e,isEnd:!1,isTimeout:!1,stuNum:"01010101",name:"John Doe",buildingNum:this.$route.query.bn,classRoomNum:this.$route.query.crn};console.log(i),(0,r.WX)(i).then((t=>{console.log(t),this.$message.success("预约成功"),next()})).catch((t=>{console.log(t),this.$message.success("预约失败")}))},renew(){this.value2="",query(),this.startTime="",this.endTime="",this.timeLimite="",this.chooseDd=""}},mounted(){this.query()}}),o=l,u=i(1001),c=(0,u.Z)(o,s,a,!1,null,"07ffa0af",null),m=c.exports}}]);